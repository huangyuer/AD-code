<!DOCTYPE html>
<html lang="en">

<head>
    <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no' />
    <meta charset='utf-8'>
    <title>微信分享 接口整理示例</title>
    <script src="http://cdnclient.elloworld.cn/a2/js/jquery-3.2.1.min.js"></script>
    <script src="http://res2.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
    <!--<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>-->
    <!--<script src="//res.wx.qq.com/open/js/jweixin-1.3.1.js"></script>-->
    <script>
        //定义分享信息
        var shareobj = {
            'title': "大事不好！容么么出走了！",
            'desc': "在皇上生下第十四胎后，容么么不堪重负连夜逃回了老家..",
            'link': "http://ad.kurite.com/local/index.html",
            'imgUrl': "http://client.elloworld.cn/test/share/share.jpg"
        };
    </script>
</head>

<body>
    ElloWorld分享测试
    <script>
        $.post('http://ad.kurite.com/api/v1/getSignature', {
            "url": "http://ad.kurite.com/local/index.html"
        }, function(data) {
            var key = data.data;
            console.log(key.timestamp, key.nonce_str, key.signature, "----")
            var wxconfig = {
                debug: true,
                appId: "wx8ef854b5878d3b8d",
                timestamp: key.timestamp,
                nonceStr: key.nonce_str,
                signature: key.signature,
                jsApiList: [
                    "onMenuShareTimeline",
                    "onMenuShareAppMessage",
                    "onMenuShareQQ",
                    "onMenuShareWeibo"
                ]
            };
            //微信接口设置，一般不用改
            //console.log(wxconfig);
            wx.config(wxconfig);

            wx.ready(function() {
                setShareInfo();
            });

            wx.error(function(res) {
                // alert("丢丢地")
                console.log(res)
                    // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
            });
        });

        function setShareInfo() {
            ///当微信接口准备好之后进行分享行为的定义
            wx.onMenuShareTimeline({
                title: shareobj.desc,
                link: shareobj.link,
                imgUrl: shareobj.imgUrl,
                success: function() {

                },
                cancel: function() {
                    // alert('取消')
                }
            });
            wx.onMenuShareAppMessage({
                title: shareobj.title,
                desc: shareobj.desc,
                link: shareobj.link,
                imgUrl: shareobj.imgUrl,
                success: function() {

                },
                cancel: function() {

                }
            });
            wx.onMenuShareQQ({
                title: shareobj.title, // 分享标题
                desc: shareobj.desc, // 分享描述
                link: shareobj.link, // 分享链接
                imgUrl: shareobj.imgUrl, // 分享图标
                success: function() {},
                cancel: function() {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareWeibo({
                title: shareobj.title,
                desc: shareobj.desc,
                link: shareobj.link,
                imgUrl: shareobj.imgUrl,
                success: function() {},
                cancel: function() {

                }
            });
        }
    </script>
</body>

</html>